# Dogtor Burguer! - Development Progress

## Current Status: Phase 2 Complete ✅ - Ready for Phase 3

**Last Session:** 2025-01-21

---

## What's Done

### Phase 1: Core Grid & Ingredients ✅
- Grid system (4 columns, 10 max rows)
- Ingredients fall step-by-step with DOTween
- Ingredients stack on columns
- Match detection (same ingredients eliminate)
- Burger detection (bun bottom + ingredients + bun top)
- Basic scoring
- GameManager with state machine
- Debug GUI showing score/state

### Phase 2: Chef Controller & Input ✅
- `ChefController.cs` - 3 positions, movement with DOTween
- `TouchInputHandler.cs` - New Unity Input System (touch + mouse)
- **Full column swap mechanic:**
  - All stacked ingredients swap between columns
  - Falling ingredients swap if below column top + 20% buffer
  - Falling ingredient tracking in GridManager
- Chef GameObject in scene with sprite
- Input tested and working

---

## What's Next: Resume Here

### Phase 3 - Match Detection Polish
- Visual feedback when ingredients match (particles, flash)
- Score popups (floating text with DOTween)
- Screen shake on match

### Phase 4 - Burger Completion Polish
- Expand BurgerNameGenerator with larger funny names pool
- Burger completion celebration animation
- Burger name popup display

### Phase 5 - Game Flow
- Difficulty progression (speed increases over time)
- More ingredients unlock over time (start 4, grow to 7)
- Game over screen with final score
- Restart functionality

### Phase 6+ - UI, Art, Audio, Monetization

---

## Scripts Created

```
Assets/_Project/Scripts/
├── Core/
│   ├── Constants.cs        # Grid size, timing, scoring values
│   ├── GameState.cs        # Enum: Menu, Playing, Paused, GameOver
│   └── GameManager.cs      # Game loop, score, state machine
├── Grid/
│   ├── GridManager.cs      # Manages columns, match/burger detection, swap logic
│   └── Column.cs           # Stack of ingredients, swap helpers
├── Ingredients/
│   ├── IngredientType.cs   # Enum: Meat, Cheese, etc + Buns
│   ├── Ingredient.cs       # Fall behavior, column swap, DOTween animations
│   └── IngredientSpawner.cs # Periodic random spawning
├── Chef/
│   └── ChefController.cs   # Movement between 3 positions, triggers swap
└── Input/
    └── TouchInputHandler.cs # New Input System (EnhancedTouch)
```

---

## Scene Hierarchy (Current)

```
Game Scene
├── Main Camera
├── GameManager (GameObject)
│   ├── GameManager.cs
│   ├── GridManager.cs
│   ├── IngredientSpawner.cs
│   └── TouchInputHandler.cs
├── Chef (GameObject)
│   ├── SpriteRenderer
│   └── ChefController.cs
└── Column_0..3 (auto-generated by GridManager)
```

---

## Key Mechanics Implemented

### Column Swap (Chef Action)
1. Chef taps → `ChefController.SwapPlates()`
2. `GridManager.SwapColumns()` called with left/right column indices
3. All stacked ingredients swap between columns
4. Falling ingredients below threshold also swap
5. Match/burger detection runs on both columns after swap

### Falling Ingredient Tracking
- `GridManager._fallingIngredients` list tracks all falling ingredients
- Ingredients register when starting fall, unregister on land/destroy
- Used for swap detection on falling ingredients

---

## Key Constants (in Constants.cs)

- 4 columns, 10 max rows
- Cell size: 1.2 x 1.0 world units
- Grid origin: (-1.8, -4.0)
- Initial spawn interval: 2 seconds
- Initial fall step: 0.4 seconds
- Chef has 3 positions (between column pairs)
- Swap threshold: column top Y + 20% cell height

---

## Sprites Available

Located in `Assets/_Project/Sprites/`:
- **Ingredients/**: Meat, Cheese, Tomato, Onion, Pickle, Lettuce, Egg, Bun Top, Bun Bottom
- **Chef/**: Dogtor chef character sprite

---

## Git Commits

1. `37d05ae` - Initial project setup with GDD and architecture docs
2. `69a29a5` - Phase 1: Core grid system and ingredient spawning
3. `763f090` - Phase 2: Chef controller and touch input
4. `dc8f225` - Update progress documentation for session end
5. `84d4cf5` - Fix input system and implement full column swap mechanic

---

## Technical Notes

### Input System
- Using Unity's **new Input System** package (not legacy Input class)
- `EnhancedTouchSupport` enabled for touch on mobile
- `Mouse.current` for editor/standalone mouse input
- Supports tap (move/swap) and swipe (move) gestures

### DOTween Usage
- Ingredient fall: step-by-step `DOMove` with Linear ease
- Landing: `DOPunchScale` squash effect
- Column swap: ingredients `DOMove` to new positions with OutBack ease
- Chef movement: `DOMove` with OutBack ease
- Destruction: `DOScale` to zero + `DORotate`
