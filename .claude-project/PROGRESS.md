# Dogtor Burguer! - Development Progress

## Current Status: Phase 5 Complete ✅ - Ready for Phase 6

**Last Session:** 2026-01-23

---

## What's Done

### Phase 1: Core Grid & Ingredients ✅
- Grid system (4 columns, 10 max rows)
- Ingredients fall step-by-step with DOTween
- Ingredients stack on columns
- Match detection (same ingredients eliminate)
- Burger detection (bun bottom + ingredients + bun top)
- Basic scoring
- GameManager with state machine
- Debug GUI showing score/state

### Phase 2: Chef Controller & Input ✅
- `ChefController.cs` - 3 positions, movement with DOTween
- `TouchInputHandler.cs` - New Unity Input System (touch + mouse)
- Full column swap mechanic with wave effects
- Falling ingredient swap below threshold
- Chef 180° flip animation on swap

### Phase 3: Match Detection Polish ✅
- `ScorePopup.cs` - Floating "+N" text that rises and fades
- `FeedbackManager.cs` - Centralized effect manager
- Ingredient blink effect before destruction (DestroyWithFlash)
- Camera shake on matches (subtle)
- Position-aware events (OnMatchEffect, OnBurgerEffect)

### Phase 4: Burger Completion Polish ✅
- `BurgerPopup.cs` - Scale-pop name + score display
- Expanded burger name generator (60+ English combos, size-aware)
- Screen flash on burger completion (runtime white sprite)
- Stronger camera shake for burgers

### Phase 5: Game Flow & Difficulty ✅
- `DifficultyManager.cs` - 10-level progression based on ingredients placed
- Easier starting difficulty (3s spawn, 0.6s fall, 3 ingredient types)
- Ramps to max difficulty (0.8s spawn, 0.15s fall, 7 types)
- Level thresholds: 0, 3, 7, 12, 18, 25, 33, 42, 52, 64 ingredients
- Level display in HUD
- Game over label + restart button (visible in builds)
- Auto-resolving references (no manual inspector wiring needed)

---

## What's Next: Resume Here

### Phase 6 - UI & Polish
- Proper Canvas-based HUD (score, level) replacing OnGUI
- Game over panel with animation
- Audio manager & sound effects (placeholder beeps ok)

### Phase 7 - Art & Audio Integration
- Final sprites (cartoon style)
- Sprite animations (idle wobble, land squash)
- Background art
- Music & sound effects

### Phase 8 - Monetization & Menus
- Ad integration
- Gems/currency system
- Main menu
- Continue-with-ad functionality

---

## Scripts Created

```
Assets/_Project/Scripts/
├── Core/
│   ├── Constants.cs           # Grid size, timing, scoring, difficulty
│   ├── GameState.cs           # Enum: Menu, Playing, Paused, GameOver
│   ├── GameManager.cs         # Game loop, score, state machine, HUD
│   ├── DifficultyManager.cs   # Level progression, spawner control
│   └── FeedbackManager.cs     # Score popups, burger popups, shake, flash
├── Grid/
│   ├── GridManager.cs         # Columns, match/burger detection, swap, events
│   └── Column.cs              # Stack of ingredients, swap helpers
├── Ingredients/
│   ├── IngredientType.cs      # Enum: Meat, Cheese, etc + Buns
│   ├── Ingredient.cs          # Fall, animations, DestroyWithFlash
│   └── IngredientSpawner.cs   # Periodic spawning, difficulty-controlled
├── Chef/
│   └── ChefController.cs      # Movement, flip animation, triggers swap
├── Input/
│   └── TouchInputHandler.cs   # New Input System (EnhancedTouch)
└── UI/
    ├── ScorePopup.cs          # Floating score text (TMPro + DOTween)
    └── BurgerPopup.cs         # Burger name + score display
```

---

## Scene Hierarchy (Current)

```
Game Scene
├── Main Camera
│   └── ScreenFlash (auto-created by FeedbackManager)
├── GameManager (GameObject)
│   ├── GameManager.cs
│   ├── GridManager.cs
│   ├── IngredientSpawner.cs
│   ├── TouchInputHandler.cs
│   ├── FeedbackManager.cs
│   └── DifficultyManager.cs
├── Chef (GameObject)
│   ├── SpriteRenderer
│   └── ChefController.cs
└── Column_0..3 (auto-generated by GridManager)
```

---

## Key Constants (in Constants.cs)

- 4 columns, 10 max rows
- Cell size: 1.2 x 1.0 world units
- Grid origin: (-1.8, -4.0)
- Starting spawn interval: 3.0 seconds (was 2.0)
- Starting fall step: 0.6 seconds (was 0.4)
- Min spawn interval: 0.8 seconds (level 10)
- Min fall step: 0.15 seconds (level 10)
- Starting ingredients: 3 types, max 7
- 10 difficulty levels
- Chef has 3 positions (between column pairs)

---

## Technical Notes

### Difficulty System
- Level based on ingredients placed (not score)
- DifficultyManager lerps between initial/min Constants values
- Auto-finds GridManager and IngredientSpawner references

### Feedback System
- FeedbackManager subscribes to GridManager events (OnMatchEffect, OnBurgerEffect)
- ScorePopup: world-space TextMeshPro, rises and fades
- BurgerPopup: scale-pop with name + score, holds 1s, fades
- Screen flash: runtime-generated white sprite on camera
- Camera shake: DOShakePosition, resets to original pos

### Input System
- Unity's new Input System (not legacy)
- EnhancedTouchSupport for mobile
- Mouse.current for editor/standalone
- Tap (move/swap) and swipe (move) gestures

### DOTween Usage
- Ingredient fall: step-by-step DOMove with Linear ease
- Landing: DOPunchScale squash effect
- Column swap: DOMove with wave delay + DOPunchScale
- Chef movement: DOMove with OutBack ease
- Chef flip: DORotate Y 180° on swap
- Destruction: blink (DOColor clear/white) + DOScale + DORotate
- Score popup: DOMove up + alpha fade + DOScale
- Burger popup: DOScale overshoot + hold + fade
- Screen flash: DOColor clear with OutQuad
- Camera shake: DOShakePosition
